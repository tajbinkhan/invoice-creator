$(".date-picker").datepicker({autoclose:!0,orientation:"bottom",format:"dd/mm/yyyy"}),$(document).ready(function(){$(".currencypicker ").select2({placeholder:"Select a client",minimumResultsForSearch:1/0});for(var e=0;e<currentFormCount;e++)$(`#id_proforma_goods-${e}-unit`).select2({minimumResultsForSearch:1/0})});for(var deleteButtons=document.querySelectorAll(".form-check-label"),i=0;i<deleteButtons.length;i++){const e=deleteButtons[i].getAttribute("for");"id_proforma_goods-__prefix__-DELETE"!=e&&deleteButtons[i].setAttribute("class","btn btn-danger waves-effect waves-light w-md form-check-label")}const addMoreBtn=document.getElementById("add-goods"),totalNewForms=document.getElementById("id_proforma_goods-TOTAL_FORMS"),element=document.getElementById("instruction"),currentGoodsForms=document.getElementsByClassName("goods-list"),currentFormCount=currentGoodsForms.length;deleteButtons.forEach(function(e){e.addEventListener("click",function(){var e=this.closest(".goods-list");e.style.display="none"})}),currentFormCount>0&&(element.style.display="none"),addMoreBtn.addEventListener("click",e=>{e&&e.preventDefault(),element&&(element.style.display="none");const t=document.getElementById("goods-form"),r=document.getElementById("empty-form").cloneNode(!0),o=currentGoodsForms.length;r.setAttribute("class","row goods-list dynamic-proforma_goods"),r.setAttribute("id",`form-${o}`);const l=new RegExp("__prefix__","g");r.innerHTML=r.innerHTML.replace(l,o),totalNewForms.setAttribute("value",o+1),t.append(r);const d=document.getElementById(`div_id_proforma_goods-${o}-product`),n=document.getElementById(`div_id_proforma_goods-${o}-quantity`),i=document.getElementById(`div_id_proforma_goods-${o}-unit`),s=document.getElementById(`div_id_proforma_goods-${o}-unit_price`),c=document.getElementById(`div_id_proforma_goods-${o}-DELETE`);d.setAttribute("class","col-sm-12 col-md-6 col-lg-3 mb-3"),n.setAttribute("class","col-sm-12 col-md-6 col-lg-3 mb-3"),i.setAttribute("class","col-sm-12 col-md-6 col-lg-3 mb-3"),s.setAttribute("class","col-sm-12 col-md-6 col-lg-3 mb-3"),c.setAttribute("class","col-sm-12 col-md-6 col-lg-3");var m=`id_proforma_goods-${o}-DELETE`,a=document.querySelector('label[for="'+m+'"]');a.style.display="none",$(`#id_proforma_goods-${o}-unit`).select2({minimumResultsForSearch:1/0});const u=document.createElement("button");u.innerHTML="Delete",u.setAttribute("class","btn btn-danger waves-effect waves-light w-md"),u.addEventListener("click",()=>{const e=document.getElementsByClassName("goods-list"),t=document.getElementById("id_proforma_goods-TOTAL_FORMS");t.value=e.length-1,e.length-1==0?element.style.display="block":element.style.display="none";var o=r,l=Array.from(e),d=l.indexOf(o);if(r.remove(),-1!==d){l.splice(d,1);for(var n=d;n<l.length;n++){var i=l[n].id.replace(/\d+/,n);l[n].id=i;var s=l[n].children,c=Array.from(s),m=Array.from(document.getElementsByClassName("select2-selection__rendered")),a=m[2].id.replace(/-\d+-/,`-${n}-`);m[2].id=a;for(var u=0;u<c.length;u++){var g=c[u].getAttribute("id"),f=c[u].getAttribute("name");if(null!==g){var y=c[u].getAttribute("id").replace(/\d+/,n);c[u].setAttribute("id",y);var A=Array.from(document.getElementById(c[u].getAttribute("id")).children);A.forEach(function(e){if(null!==e.getAttribute("id")){var t=e.getAttribute("id").replace(/\d+/,n);e.setAttribute("id",t),e.getAttribute("id")===`id_proforma_goods-${n}-unit`&&$(`#id_proforma_goods-${n}-unit`).select2({minimumResultsForSearch:1/0})}if(null!==e.getAttribute("name")){var r=e.getAttribute("name").replace(/\d+/,n);e.setAttribute("name",r)}if(null!==e.getAttribute("for")){var o=e.getAttribute("for").replace(/\d+/,n);e.setAttribute("for",o)}})}if(null!==f){var b=c[u].getAttribute("name").replace(/\d+/,n);c[u].setAttribute("name",b)}}var p=Array.from(document.querySelectorAll(`#${l[n].id}`))[0].children.length,_=Array.from(Array.from(Array.from(document.querySelectorAll(`#${l[n].id}`))[0].children)[p-1].children)[0];console.log();var v=Array.from(Array.from(Array.from(document.querySelectorAll(`#${l[n].id}`))[0].children)[p-1].children)[0].children,E=_.id.replace(/\d+/,n),h=v[0].getAttribute("id").replace(/\d+/,n),B=v[0].getAttribute("name").replace(/\d+/,n),F=v[1].getAttribute("for").replace(/\d+/,n);_.id=E,v[0].setAttribute("id",h),v[0].setAttribute("name",B),v[1].setAttribute("for",F)}}}),c.appendChild(u)});